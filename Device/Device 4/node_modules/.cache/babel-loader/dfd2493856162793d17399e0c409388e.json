{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\abhi\\\\Desktop\\\\etherium\\\\endproject\\\\Device\\\\Device 1\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport React, { Component } from 'react';\nimport logo from \"./logo.svg\";\nimport './App.css';\nimport mqtt from 'mqtt';\nimport { useCallback, useEffect, useState } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Button from 'react-bootstrap/Button';\nimport { Container, Row, Col, ListGroup, ListGroupItem, Form } from 'react-bootstrap';\nimport myBackground from './background.jpg';\nimport bgpLogo from \"./router.svg\";\nimport desktopMonitor from \"./desktop-monitor.svg\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst elliptic = require('elliptic');\n\nconst sha3 = require('js-sha3');\n\nvar ecies = require(\"eciesjs\");\n\nconst ec = new elliptic.ec('secp256k1');\nvar gateway1_pubKey = '02d3846591c11ef39031b9dd7594de19d2d2f99dd512892e13840b855194432975';\nvar client; //Instance to coimport React, { Component }  from 'react';\n\nvar sendMsg = \"HELLO\";\nvar bogus_priv = \"e6e1031b9eff10cd5b97a2f6a5ffc1d1d42e2ebd3eef6b050b8400259aaf3de1\";\n/*******************UTILITY FUNCTIONS*****************/\n\n/*\n'Encrypt' function receives 2 parameters:\n1. snd - An object\n2. pubK - public key of the receiver\n\nReturns the cipher string\n*/\n\nfunction encrypt(snd, pubK) {\n  //Uses receivers public key to encrypt.\n  let cipher = ecies.encrypt(pubK, Buffer.from(JSON.stringify(snd)));\n  let cipher_str = cipher.toString('hex');\n  return cipher_str;\n}\n/*\n'Decrypt' function receives two parameters:\n1. rcv - Cipher text in the form of buffer.\n2. prvK - Own private key\n\nReturns the decrypted object\n*/\n\n\nfunction decrypt(rcv, prvK) {\n  //Uses own private key to decrypt.\n  let cipher_str = rcv.toString(); // console.log(\"Received - Encrypted message (String): \", cipher_str);\n\n  let cipher = Buffer.from(cipher_str, 'hex'); // console.log(\"Received - Encrypted message (Buffer): \", cipher);\n\n  var rcv_data = ecies.decrypt(prvK, cipher).toString();\n  rcv_data = JSON.parse(rcv_data);\n  return rcv_data;\n}\n/*\n'sign_it' function\nParameters:\n1. prvK - Own private key\n2. Other parameters which are to be concatenated,\nhashed and then signed can be accessed through 'arguments'.\n\n\nReturns the signature object of the form:\n{\n  r:string,\n  s: string,\n  recover paramters: number\n}\n*/\n\n\nfunction sign_it(prvK) {\n  let msg = \"\";\n\n  for (let i = 1; i < arguments.length; i++) msg += arguments[i];\n\n  let msgHash = sha3.keccak256(msg);\n  let signature = ec.sign(msgHash, prvK, \"hex\", {\n    canonical: true\n  }); //The signature below consists of parameters 'r' and 's'.\n\n  let sign_str = JSON.parse(JSON.stringify(signature));\n  return sign_str;\n}\n/**\n'verify' function:\nParameters:\n1. signature - An object same as the type returned by 'sign_it'\n2. pubK - public key to be verified with.\n3. Other parameters which are to be concatenated and hashed can be accessed through 'arguments'.\n\nReturn: Boolean value indicating the authentcation status.\n*/\n\n\nfunction verify(signature, pubK) {\n  let pubKeyObj = ec.keyFromPublic(pubK, \"hex\");\n  let msg = \"\";\n\n  for (let i = 2; i < arguments.length; i++) msg += arguments[i];\n\n  let msgHash = sha3.keccak256(msg);\n  let auth_status = pubKeyObj.verify(msgHash, signature);\n  return auth_status;\n}\n/******************COMPONENT FUNCTION***********************/\n\n\nfunction App() {\n  _s();\n\n  /***************INITILIAZING STATES********************/\n  //Set of keys\n  const [keyPair, setKeyPair] = useState({\n    pubKey: null,\n    privKey: null,\n    privKey_0x: null\n  });\n  const [toggle, setToggle] = useState(false); //This state stores the status of the device.\n\n  const [status, setStatus] = useState({\n    gen: false,\n    //Whether the keys have been generated.\n    start_button_clicked: false,\n    connected: false,\n    registered: false,\n    cur_time_stamp: null\n  });\n  const [regStatus, setReg] = useState({\n    reg_button_clicked: false,\n    req: null,\n    ct: null,\n    res: null\n  });\n  const [authStatus, setAuth] = useState({\n    auth_button_clicked: false,\n    ts1: null,\n    //Timestamp when the device is sending the authentication request\n    ct1: null,\n    //Cipher text when sending the request\n    res1: null,\n    //Nonce as cipher text sent by the gateway as response 1\n    res2: null,\n    //Authentication status as a cipher text as response 2 but not yet used\n    data: null,\n    //Nonce (and receivers public key) received from the gateway\n    //data2: null, //Data to be send after receiving the nonce (receiver's public key)\n    //ct2: null, // cipher text for data2\n    res: null //Authentication status as a boolean value\n\n  });\n  const [commStatus, setComm] = useState({\n    comm_button_clicked: false,\n    devID: \"\",\n    res: null,\n    //Whole message sent by gateway as cipher text\n    data: null,\n    //Decrypted form of Whole message\n    msg: null\n  });\n  const [buttonStatus, setButton] = useState({\n    keysClicked: false,\n    startClicked: false,\n    registerClicked: false,\n    authClicked: false,\n    data: null\n  }); // const [msg_to_send, setMsg] = useState(\"\");\n\n  useEffect(() => {\n    console.log(\"Key pair changed: \", keyPair);\n  }, [keyPair]);\n  useEffect(() => {\n    console.log(\"Registration status changed: \", status.registered);\n  }, [status.registered]); // useEffect(() => {\n  //   console.log(\"Comm status has been changed: \", commStatus);\n  // }, [commStatus])\n\n  /***************GENERATE KEYS HANDLER********************/\n\n  function handleGenerate() {\n    console.log(\"Generating key pair...\"); //Creating public and private keys for the device.\n\n    var pair = ec.genKeyPair();\n    var priv = pair.getPrivate(\"hex\"); // var priv = \"6b5be97bc9065592a6eb9444f90991ca32659673fb7307a44f6948193e7b44bf\";\n\n    var pub = ec.keyFromPrivate(priv).getPublic(true, \"hex\"); // var pub = \"0206fe0109380bb9fb59cfaf24c7db9626a9bed8d1ae3c89e50d2f7671e81ee023\";\n\n    var priv_0x = \"0x\" + priv;\n    var Id = sha3.keccak256(pub + gateway1_pubKey);\n    setKeyPair({\n      pubKey: pub,\n      privKey: priv,\n      privKey_0x: priv_0x,\n      devId: Id\n    });\n    setStatus(prev => ({ ...prev,\n      gen: true\n    }));\n    setButton(prev => ({ ...prev,\n      keysClicked: true,\n      startClicked: false,\n      registerClicked: false,\n      authClicked: false\n    }));\n    let dat = new Date(\"2000-01-01\");\n    localStorage.setItem('cur_time_stamp', dat.toString());\n    localStorage.setItem('old', false);\n    localStorage.setItem('gate', true);\n  }\n  /***************CONNECTING AND SUBSCRIBING TO MQTT AND MAIN LOGIC FOR RECEIVING MESSAGES AND REPSONDING********************/\n\n  /***** This handler connects the device to the broker and subscribes to listen for responses *****/\n  // function respond_nonce(){\n  //   console.log(\"Wait...\");\n  // }\n\n\n  function handleStart() {\n    console.log(\"Device start button clicked...\");\n    setStatus(prev => ({ ...prev,\n      start_button_clicked: true\n    }));\n    setButton(prev => ({ ...prev,\n      keysClicked: false,\n      startClicked: true,\n      registerClicked: false,\n      authClicked: false\n    }));\n    client = mqtt.connect('mqtt://test.mosquitto.org:8081', {\n      protocol: 'mqtts'\n    });\n    let data = {\n      privKey: keyPair.privKey\n    };\n    let cipher = ecies.encrypt(gateway1_pubKey, Buffer.from(JSON.stringify(data)));\n    let cipher_str = cipher.toString('hex');\n    client.publish('gateway1/priv', cipher_str);\n    client.on('connect', () => {\n      /***************SUBSCRIBE TO DEVICE-ID********************/\n      client.subscribe(keyPair.devId, function (err) {\n        if (!err) {\n          console.log(\"Device started...\");\n          setStatus(prev => ({ ...prev,\n            connected: true\n          }));\n        } else {\n          console.log(\"Error starting the device...\");\n        }\n      });\n      /**********MESSAGE LISTENERS**************/\n\n      client.on('message', (topic, rcv) => {\n        if (topic !== keyPair.devId) return;\n        var data = decrypt(rcv, keyPair.privKey_0x);\n        console.log(\"Gateway response received: \", data); // console.log(\"Current time stamp: \", localStorage.getItem('cur_time_stamp'));\n\n        /***********REGISTRATION LISTENER***********/\n\n        if (data.remark === \"register\") {\n          if (data.status) {\n            console.log(\"Device has been registered...Proceed for authentication!!\");\n            setStatus(prev => ({ ...prev,\n              registered: true\n            }));\n            setReg(prev => ({ ...prev,\n              res: true\n            }));\n          } else {\n            console.log(\"Error registering the device...\");\n          }\n        }\n        /***********NONCE LISTENER***********/\n        else if (data.remark === \"nonce\") {\n            if (!data.status) {\n              console.log(\"Device not registered...\");\n              return;\n            }\n\n            if (data.recvKey) localStorage.setItem('recvKey', data.recvKey);\n            setAuth(prev => ({ ...prev,\n              res1: rcv.toString(),\n              data: data\n            })); //We have received the nonce (and receivers public key)\n            //1. Check whether the timestamp is new.\n            //2. Check the gateway\n            //3. Hash the contents and sign it\n            //4. Encrypt with gateways public key and send.\n\n            let d1 = new Date(data.time_stamp);\n            let d2 = new Date(localStorage.getItem('cur_time_stamp')); // console.log(\"d1: \", d1.toString(), \"\\nd2: \", d2.toString());\n            // 1.\n            // !status.cur_time_stamp\n\n            if (d1.getTime() > d2.getTime()) {//2.\n              // let pubKeyObj = ec.keyFromPublic(gateway1_pubKey,\"hex\");\n              // let msgHash = sha3.keccak256(data.time_stamp);\n              // // console.log(\"Message hash: \", msgHash);\n              // let auth_status = pubKeyObj.verify(msgHash, data.sign);\n              // if(auth_status)\n              // {\n              //   //3.\n              //   // console.log(\"The text message and receiver public key just before sending: \", localStorage.getItem('msg'), \" \", localStorage.getItem('recvKey'));\n              //   //export NODE_OPTIONS=--openssl-legacy-provider\n              //   let recvKey = localStorage.getItem('recvKey');\n              //   let msg = (localStorage.getItem('msg').length === 0) ? \"\" : encrypt(localStorage.getItem('msg'), recvKey);\n              //   // bogus_priv\n              //   let sign = sign_it(keyPair.privKey, data.nonce);\n              //   let snd = {\n              //   devId: keyPair.devId,\n              //   sign: sign,\n              //   msg:  msg,\n              //   }\n              //   console.log(\"Sending the message: \", snd);\n              //   let enc_data = encrypt(snd, gateway1_pubKey);\n              //   client.publish('gateway1/auth', enc_data);\n              //   //Update the timestamp state.\n              //   // setStatus((prev) => ({\n              //   //   ...prev,\n              //   //   cur_time_stamp:data.time_stamp\n              //   // }))\n              //   setAuth((prev) => ({\n              //     ...prev,\n              //     data2: snd,\n              //     ct2: enc_data,\n              //   }))\n              //   // localStorage.setItem('old', false);\n              //   localStorage.setItem('gate', true);\n              //   localStorage.setItem('cur_time_stamp', data.time_stamp);\n              //   // console.log(\"Current time stamp now: \", localStorage.getItem('cur_time_stamp'));\n              // }\n              //   else\n              //   {\n              //     console.log(\"Gateway signature verification failed...\");\n              //     setAuth((prev) => ({\n              //       ...prev,\n              //       data2: null,\n              //       ct2: null\n              //     }))\n              //     localStorage.setItem('gate', false);\n              //   }\n            } else {\n              console.log(\"Timestamp is old: \");\n              console.log(\"Latest timestamp stored: \", localStorage.getItem('cur_time_stamp'));\n              console.log(\"Received time stamp: \", data.time_stamp);\n              setAuth(prev => ({ ...prev,\n                data2: null,\n                ct2: null\n              })); // localStorage.setItem('old', true);\n\n              localStorage.setItem('gate', false);\n            }\n          }\n          /***********AUTH LISTENER***********/\n          else if (data.remark === \"auth\") {\n              //This is the response from the gateway after processing the request.\n              //1. Check gateway.\n              //2. Check status.\n              let d1 = new Date(data.time_stamp);\n              let d2 = new Date(status.cur_time_stamp);\n\n              if (!status.cur_time_stamp || d1.getTime() > d2.getTime()) {\n                let pubKeyObj = ec.keyFromPublic(gateway1_pubKey, \"hex\");\n                let msgHash = sha3.keccak256(data.time_stamp);\n                let auth_status = pubKeyObj.verify(msgHash, data.sign);\n\n                if (auth_status) {\n                  setAuth(prev => ({ ...prev,\n                    res: data.status\n                  }));\n                  console.log(\"Auth status received: \", data.status);\n                } else console.log(\"Gateway signature verification failed...\");\n              } else console.log(\"Timestamp is old...\");\n            } else if (data.remark === \"message\") {\n              let d1 = new Date(data.time_stamp);\n              let d2 = new Date(status.cur_time_stamp);\n              console.log(\"Received a message: \", data.msg);\n\n              if (d1.getTime() > d2.getTime()) {\n                let auth_status = verify(data.sign, gateway1_pubKey, data.time_stamp);\n\n                if (auth_status) {\n                  setStatus(prev => ({ ...prev,\n                    cur_time_stamp: data.time_stamp\n                  }));\n                  setComm(prev => ({ ...commStatus,\n                    res: rcv.toString(),\n                    data: data,\n                    enc: data.msg,\n                    msg: decrypt(data.msg, keyPair.privKey_0x)\n                  }));\n                } else {\n                  console.log(\"Cannot verify gateway signature...\");\n                }\n              } else {\n                console.log(\"Timestamp is old...\");\n              }\n            }\n      });\n    });\n  }\n  /***************DEVICE REGISTRATION HANDLER********************/\n\n\n  function handleRegister() {\n    console.log(\"Requesting registration...\"); //The devID, PubKey encrypted with gateway public key is sent to the gateway on the topic register1.\n\n    let d = new Date();\n    let d_str = d.toString();\n    let sign = sign_it(keyPair.privKey, d_str);\n    let data = {\n      devId: keyPair.devId,\n      pubKey: keyPair.pubKey,\n      TS: d_str,\n      sign: sign\n    };\n    let cipher = ecies.encrypt(gateway1_pubKey, Buffer.from(JSON.stringify(data)));\n    let cipher_str = cipher.toString('hex');\n    setReg(prev => ({ ...prev,\n      reg_button_clicked: true,\n      req: data,\n      ct: cipher_str\n    }));\n    setButton(prev => ({ ...prev,\n      keysClicked: false,\n      startClicked: false,\n      registerClicked: true,\n      authClicked: false\n    }));\n    client.publish('gateway1/register', cipher_str);\n  }\n  /***************DEVCE AUTHENTICATION HANDLER********************/\n\n\n  function handleAuth() {\n    //Here the device requests the gateway for authentication.\n    //The gateway responds by sending a nonce.\n    console.log(\"Requesting for authentication...\");\n    setAuth(prev => ({ ...prev,\n      auth_button_clicked: commStatus.devID.length === 0\n    }));\n    setComm(prev => ({ ...prev,\n      comm_button_clicked: commStatus.devID.length !== 0\n    }));\n    let d = new Date();\n    let d_str = d.toString();\n    let data = {\n      devId: keyPair.devId,\n      TS: d_str,\n      recvId: commStatus.devID.length !== 0 ? commStatus.devID : null\n    };\n    let cipher = ecies.encrypt(gateway1_pubKey, Buffer.from(JSON.stringify(data)));\n    let cipher_str = cipher.toString('hex');\n    setAuth(prev => ({ ...prev,\n      ts1: d_str,\n      ct1: cipher_str\n    }));\n    setButton(prev => ({ ...prev,\n      keysClicked: false,\n      startClicked: false,\n      registerClicked: false,\n      authClicked: true\n    }));\n    client.publish('gateway1/nonce', cipher_str);\n  }\n\n  function onDevId(e) {\n    setComm(prev => ({ ...prev,\n      devID: e.target.value\n    }));\n  }\n\n  function onMsg(e) {\n    // setMsg((prev) => (e.target.value));\n    localStorage.setItem('msg', e.target.value);\n  }\n  /************************COMPONENT TO BE RENDERED*****************************/\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"page-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: bgpLogo,\n        height: \"45\",\n        width: \"45\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 546,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"  BGP Device \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 547,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"page-border\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"parent\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"buttons\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          className: \"button\",\n          id: \"button1\",\n          onClick: handleGenerate,\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            class: \"front\",\n            children: \" Keys \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 553,\n            columnNumber: 81\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 553,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"vertical\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"button\",\n          id: \"button2\",\n          onClick: handleStart,\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            class: \"front\",\n            children: \"Start the device \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 555,\n            columnNumber: 78\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"vertical\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"button\",\n          id: \"button3\",\n          onClick: handleRegister,\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            class: \"front\",\n            children: \" Register \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 557,\n            columnNumber: 80\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"vertical\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 558,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"button\",\n          id: \"button4\",\n          onClick: handleAuth,\n          disabled: false,\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            class: \"front\",\n            children: \"Authenticate \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 559,\n            columnNumber: 91\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"cards\",\n        children: [!buttonStatus.keysClicked && !buttonStatus.startClicked && !buttonStatus.registerClicked && !buttonStatus.authClicked ? /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card1\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \" >> Hi, Welcome to BGP simulation \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 568,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 567,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), buttonStatus.keysClicked && keyPair.privKey ? /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card1\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \" >> Keys \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Device Id: \", keyPair.devId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Public key: \", keyPair.pubKey]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 583,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Private key: \", keyPair.privKey]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 584,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), buttonStatus.startClicked && status.start_button_clicked ? /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card1\",\n          children: !status.connected ? /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \" Connecting to broker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 14\n          }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Device Ready!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 49\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 594,\n          columnNumber: 9\n        }, this) : null, buttonStatus.registerClicked && regStatus.reg_button_clicked ? /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card1\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Requesting registration...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 608,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"card2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n              children: \"Device to gateway\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 610,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Device ID: \", keyPair.devId]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 611,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Public key: \", keyPair.pubKey]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 13\n            }, this), regStatus.req ? /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Timestamp of the request: \", regStatus.req.TS]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 616,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Signature (r, s): ( r: \", regStatus.req.sign.r.substring(0, 40), \", s: \", regStatus.req.sign.s.substring(0, 40), \" )\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 617,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 615,\n              columnNumber: 15\n            }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Signing...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 620,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Encrypted request: \", regStatus.ct ? regStatus.ct.substring(0, 40) + \"...\" : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 622,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 609,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"card2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n              children: \"Gateway to device\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 626,\n              columnNumber: 13\n            }, this), status.registered ? /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Registration status: TRUE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 627,\n              columnNumber: 35\n            }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Registration status: FALSE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 627,\n              columnNumber: 69\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 625,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 606,\n          columnNumber: 9\n        }, this) : null, buttonStatus.authClicked && authStatus.auth_button_clicked ? /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card1\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Starting authentication process\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 639,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"card2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n              children: \"Request from device to gateway\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 641,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Device ID: \", keyPair.devId]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 642,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Timestamp of the request: \", authStatus.ts1 ? authStatus.ts1 : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 643,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Cipher text: \", authStatus.ct1 ? authStatus.ct1.substring(0, 40) : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 644,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 640,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"card2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n              children: \"lbr response\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 648,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Received cipher text: \", authStatus.res1 ? authStatus.res1.substring(0, 40) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: \"Waiting...\"\n                }, void 0, false)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 651,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"After decrypting: \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 652,\n                columnNumber: 19\n              }, this), authStatus.data ? /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [\"Timestamp of the response: \", authStatus.data.time_stamp]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 656,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [\"Signature (r, s): ( r: \", authStatus.data.sign.r.substring(0, 40), \", s: \", authStatus.data.sign.s.substring(0, 40), \" )\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 657,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 655,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Waiting...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 660,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 650,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 647,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"card2\",\n            children: !authStatus.res ? /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: \"Authentication successful!! :)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 682,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(\"h5\", {\n              children: \"Authentication failed :(\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 682,\n              columnNumber: 74\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 637,\n          columnNumber: 9\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '50%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"Recipient deviceID: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 695,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            children: /*#__PURE__*/_jsxDEV(Form.Control, {\n              type: \"text\",\n              placeholder: \"deviceID\",\n              onChange: onDevId,\n              value: commStatus.devID,\n              style: {\n                width: '80%'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 697,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 694,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 700,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"Message\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 702,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n              type: \"text\",\n              placeholder: \"Message to send\",\n              onChange: onMsg,\n              style: {\n                width: '80%'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 704,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              id: \"button6\",\n              style: {\n                width: '100px'\n              },\n              onClick: handleAuth,\n              disabled: false,\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                class: \"front\",\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 706,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 705,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 703,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 701,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 693,\n        columnNumber: 9\n      }, this), commStatus.comm_button_clicked ? /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"card1\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Starting authenticated communication process\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 721,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"Request from device to gateway\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 724,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Device ID: \", keyPair.devId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 725,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Timestamp of the request: \", authStatus.ts1 ? authStatus.ts1 : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 726,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Receiver's device id: \", commStatus.devID ? commStatus.devID : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 727,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Cipher text: \", authStatus.ct1 ? authStatus.ct1.substring(0, 40) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 728,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 723,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"Gateway response\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 732,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Received cipher text: \", authStatus.res1 ? authStatus.res1.substring(0, 40) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: \"Waiting...\"\n            }, void 0, false)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 733,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"After decrypting: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 734,\n            columnNumber: 13\n          }, this), authStatus.data ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Timestamp of the response: \", authStatus.data.time_stamp]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 738,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Signature (r, s): ( r: \", authStatus.data.sign.r.substring(0, 40), \", s: \", authStatus.data.sign.s.substring(0, 40), \" )\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 739,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Nonce received: \", authStatus.data.nonce]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 740,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Receiver public key: \", authStatus.data.recvKey]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 741,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 737,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Waiting...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 743,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 731,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"card2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"Device sending encrypted message with signed nonce\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 748,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Device ID: \", keyPair.devId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 749,\n            columnNumber: 13\n          }, this), authStatus.data && authStatus.data2 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Nonce to be signed: \", authStatus.data.nonce]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 753,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Recipient public key: \", authStatus.data.recvKey]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 754,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Sending sample text message: \", authStatus.data2.msg.substring(0, 40) + \"...\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 755,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Device signature(r, s): ( r: \", authStatus.data2.sign.r.substring(0, 40), \", s: \", authStatus.data2.sign.s.substring(0, 40), \" )\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 756,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 752,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Preparing response\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 758,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Cipher text: \", authStatus.ct2 ? authStatus.ct2.substring(0, 40) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 760,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 747,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: '#d9f2de'\n          },\n          children: authStatus.res ? /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Message sent!!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 764,\n            columnNumber: 30\n          }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Sending failed...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 764,\n            columnNumber: 53\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 763,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 719,\n        columnNumber: 9\n      }, this) : null, commStatus.comm_button_clicked ? /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"card1\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          children: \"Messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 777,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Received cipher text: \", commStatus.res ? commStatus.res.substring(0, 40) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: \"...\"\n            }, void 0, false)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 779,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"After decrypting:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 780,\n            columnNumber: 11\n          }, this), commStatus.data ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Timestamp: \", commStatus.data.time_stamp]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 784,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Signature (r, s): ( r: \", commStatus.data.sign.r.substring(0, 40), \", s: \", commStatus.data.sign.s.substring(0, 40), \" )\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 785,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Received from: \", commStatus.data.from]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 786,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Encrypted message received: \", commStatus.enc]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 787,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Message: \", commStatus.msg]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 788,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 783,\n            columnNumber: 14\n          }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 790,\n            columnNumber: 16\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 778,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 775,\n        columnNumber: 7\n      }, this) : null, /*#__PURE__*/_jsxDEV(Button, {\n        id: \"button5\",\n        onClick: () => {\n          console.log(\"Present msg: \", localStorage.getItem('msg'));\n          console.log(\"commStatus: \", commStatus.comm_button_clicked);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          class: \"front\",\n          children: \"Print\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 802,\n          columnNumber: 12\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 799,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      src: desktopMonitor,\n      id: \"img123\",\n      width: \"800\",\n      height: \"80\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 806,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 544,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"o9DnHnBxl4ljA03/I2douLv2nHw=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["C:/Users/abhi/Desktop/etherium/endproject/Device/Device 1/src/App.js"],"names":["React","Component","mqtt","useCallback","useEffect","useState","Button","Container","Row","Col","ListGroup","ListGroupItem","Form","myBackground","elliptic","require","sha3","ecies","ec","gateway1_pubKey","client","sendMsg","bogus_priv","encrypt","snd","pubK","cipher","Buffer","from","JSON","stringify","cipher_str","toString","decrypt","rcv","prvK","rcv_data","parse","sign_it","msg","i","arguments","length","msgHash","keccak256","signature","sign","canonical","sign_str","verify","pubKeyObj","keyFromPublic","auth_status","App","keyPair","setKeyPair","pubKey","privKey","privKey_0x","toggle","setToggle","status","setStatus","gen","start_button_clicked","connected","registered","cur_time_stamp","regStatus","setReg","reg_button_clicked","req","ct","res","authStatus","setAuth","auth_button_clicked","ts1","ct1","res1","res2","data","commStatus","setComm","comm_button_clicked","devID","buttonStatus","setButton","keysClicked","startClicked","registerClicked","authClicked","console","log","handleGenerate","pair","genKeyPair","priv","getPrivate","pub","keyFromPrivate","getPublic","priv_0x","Id","devId","prev","dat","Date","localStorage","setItem","handleStart","connect","protocol","publish","on","subscribe","err","topic","remark","recvKey","d1","time_stamp","d2","getItem","getTime","data2","ct2","enc","handleRegister","d","d_str","TS","handleAuth","recvId","onDevId","e","target","value","onMsg","bgpLogo","r","substring","s","width","nonce","backgroundColor","desktopMonitor"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;AAEA,OAAO,WAAP;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,SAAQC,WAAR,EAAqBC,SAArB,EAAgCC,QAAhC,QAA+C,OAA/C;AACA,OAAO,sCAAP;AACA,OAAOC,MAAP,MAAmB,wBAAnB;AACA,SAAQC,SAAR,EAAmBC,GAAnB,EAAwBC,GAAxB,EAA6BC,SAA7B,EAAwCC,aAAxC,EAAuDC,IAAvD,QAAkE,iBAAlE;AACA,OAAOC,YAAP,MAAyB,kBAAzB;;;;;;AAIA,MAAMC,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,SAAD,CAApB;;AACA,IAAIE,KAAK,GAAGF,OAAO,CAAC,SAAD,CAAnB;;AACA,MAAMG,EAAE,GAAG,IAAIJ,QAAQ,CAACI,EAAb,CAAgB,WAAhB,CAAX;AACA,IAAIC,eAAe,GAAG,oEAAtB;AACA,IAAIC,MAAJ,C,CAAY;;AACZ,IAAIC,OAAO,GAAG,OAAd;AACA,IAAIC,UAAU,GAAG,kEAAjB;AAEA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,IAAtB,EAA2B;AACzB;AACA,MAAIC,MAAM,GAAGT,KAAK,CAACM,OAAN,CAAcE,IAAd,EAAoBE,MAAM,CAACC,IAAP,CAAYC,IAAI,CAACC,SAAL,CAAeN,GAAf,CAAZ,CAApB,CAAb;AACA,MAAIO,UAAU,GAAGL,MAAM,CAACM,QAAP,CAAgB,KAAhB,CAAjB;AACA,SAAOD,UAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASE,OAAT,CAAiBC,GAAjB,EAAsBC,IAAtB,EAA2B;AACzB;AACA,MAAIJ,UAAU,GAAGG,GAAG,CAACF,QAAJ,EAAjB,CAFyB,CAGzB;;AACA,MAAIN,MAAM,GAAGC,MAAM,CAACC,IAAP,CAAYG,UAAZ,EAAuB,KAAvB,CAAb,CAJyB,CAKzB;;AACA,MAAIK,QAAQ,GAAGnB,KAAK,CAACgB,OAAN,CAAcE,IAAd,EAAoBT,MAApB,EAA4BM,QAA5B,EAAf;AACAI,EAAAA,QAAQ,GAAGP,IAAI,CAACQ,KAAL,CAAWD,QAAX,CAAX;AACA,SAAOA,QAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAASE,OAAT,CAAiBH,IAAjB,EAAsB;AACpB,MAAII,GAAG,GAAI,EAAX;;AACA,OAAK,IAAIC,CAAC,GAAC,CAAX,EAAaA,CAAC,GAACC,SAAS,CAACC,MAAzB,EAAgCF,CAAC,EAAjC,EACED,GAAG,IAAIE,SAAS,CAACD,CAAD,CAAhB;;AACF,MAAIG,OAAO,GAAG3B,IAAI,CAAC4B,SAAL,CAAeL,GAAf,CAAd;AACA,MAAIM,SAAS,GAAG3B,EAAE,CAAC4B,IAAH,CAAQH,OAAR,EAAiBR,IAAjB,EAAuB,KAAvB,EAA8B;AAACY,IAAAA,SAAS,EAAE;AAAZ,GAA9B,CAAhB,CALoB,CAOpB;;AACA,MAAIC,QAAQ,GAAGnB,IAAI,CAACQ,KAAL,CAAWR,IAAI,CAACC,SAAL,CAAee,SAAf,CAAX,CAAf;AACA,SAAOG,QAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASC,MAAT,CAAgBJ,SAAhB,EAA2BpB,IAA3B,EAAgC;AAC9B,MAAIyB,SAAS,GAAGhC,EAAE,CAACiC,aAAH,CAAiB1B,IAAjB,EAAsB,KAAtB,CAAhB;AAEA,MAAIc,GAAG,GAAI,EAAX;;AACA,OAAK,IAAIC,CAAC,GAAC,CAAX,EAAaA,CAAC,GAACC,SAAS,CAACC,MAAzB,EAAgCF,CAAC,EAAjC,EACED,GAAG,IAAIE,SAAS,CAACD,CAAD,CAAhB;;AACF,MAAIG,OAAO,GAAG3B,IAAI,CAAC4B,SAAL,CAAeL,GAAf,CAAd;AAEA,MAAIa,WAAW,GAAGF,SAAS,CAACD,MAAV,CAAiBN,OAAjB,EAA0BE,SAA1B,CAAlB;AAEA,SAAOO,WAAP;AACD;AACD;;;AACA,SAASC,GAAT,GAAe;AAAA;;AAEb;AACA;AACA,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBlD,QAAQ,CAAC;AACrCmD,IAAAA,MAAM,EAAE,IAD6B;AAErCC,IAAAA,OAAO,EAAE,IAF4B;AAGrCC,IAAAA,UAAU,EAAE;AAHyB,GAAD,CAAtC;AAMA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBvD,QAAQ,CAAC,KAAD,CAApC,CAVa,CAYb;;AACA,QAAM,CAACwD,MAAD,EAASC,SAAT,IAAsBzD,QAAQ,CAAC;AACnC0D,IAAAA,GAAG,EAAE,KAD8B;AACvB;AACZC,IAAAA,oBAAoB,EAAE,KAFa;AAGnCC,IAAAA,SAAS,EAAE,KAHwB;AAInCC,IAAAA,UAAU,EAAE,KAJuB;AAKnCC,IAAAA,cAAc,EAAE;AALmB,GAAD,CAApC;AAQA,QAAM,CAACC,SAAD,EAAYC,MAAZ,IAAsBhE,QAAQ,CAAC;AACnCiE,IAAAA,kBAAkB,EAAE,KADe;AAEnCC,IAAAA,GAAG,EAAE,IAF8B;AAGnCC,IAAAA,EAAE,EAAE,IAH+B;AAInCC,IAAAA,GAAG,EAAE;AAJ8B,GAAD,CAApC;AAOA,QAAM,CAACC,UAAD,EAAaC,OAAb,IAAwBtE,QAAQ,CAAC;AACrCuE,IAAAA,mBAAmB,EAAE,KADgB;AAErCC,IAAAA,GAAG,EAAC,IAFiC;AAE3B;AACVC,IAAAA,GAAG,EAAC,IAHiC;AAG3B;AACVC,IAAAA,IAAI,EAAE,IAJ+B;AAIzB;AACZC,IAAAA,IAAI,EAAC,IALgC;AAK1B;AACXC,IAAAA,IAAI,EAAE,IAN+B;AAMzB;AACZ;AACA;AACAR,IAAAA,GAAG,EAAC,IATiC,CAS5B;;AAT4B,GAAD,CAAtC;AAaA,QAAM,CAACS,UAAD,EAAaC,OAAb,IAAwB9E,QAAQ,CAAC;AACrC+E,IAAAA,mBAAmB,EAAE,KADgB;AAErCC,IAAAA,KAAK,EAAE,EAF8B;AAGrCZ,IAAAA,GAAG,EAAE,IAHgC;AAG1B;AACXQ,IAAAA,IAAI,EAAE,IAJ+B;AAIxB;AACb1C,IAAAA,GAAG,EAAE;AALgC,GAAD,CAAtC;AASA,QAAM,CAAC+C,YAAD,EAAeC,SAAf,IAA4BlF,QAAQ,CAAC;AACzCmF,IAAAA,WAAW,EAAE,KAD4B;AAEzCC,IAAAA,YAAY,EAAE,KAF2B;AAGzCC,IAAAA,eAAe,EAAE,KAHwB;AAIzCC,IAAAA,WAAW,EAAE,KAJ4B;AAKzCV,IAAAA,IAAI,EAAE;AALmC,GAAD,CAA1C,CAlDa,CA0Db;;AAEA7E,EAAAA,SAAS,CAAC,MAAM;AACZwF,IAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCvC,OAAlC;AACH,GAFQ,EAEN,CAACA,OAAD,CAFM,CAAT;AAIAlD,EAAAA,SAAS,CAAC,MAAM;AACdwF,IAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ,EAA6ChC,MAAM,CAACK,UAApD;AACH,GAFU,EAER,CAACL,MAAM,CAACK,UAAR,CAFQ,CAAT,CAhEa,CAoEb;AACA;AACA;;AAEA;;AACA,WAAS4B,cAAT,GAAyB;AACvBF,IAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EADuB,CAGvB;;AACA,QAAIE,IAAI,GAAG7E,EAAE,CAAC8E,UAAH,EAAX;AACA,QAAIC,IAAI,GAAGF,IAAI,CAACG,UAAL,CAAgB,KAAhB,CAAX,CALuB,CAMvB;;AACA,QAAIC,GAAG,GAAGjF,EAAE,CAACkF,cAAH,CAAkBH,IAAlB,EAAwBI,SAAxB,CAAkC,IAAlC,EAAuC,KAAvC,CAAV,CAPuB,CAQvB;;AAEA,QAAIC,OAAO,GAAG,OAAOL,IAArB;AACA,QAAIM,EAAE,GAAGvF,IAAI,CAAC4B,SAAL,CAAeuD,GAAG,GAAChF,eAAnB,CAAT;AAEAoC,IAAAA,UAAU,CAAC;AACTC,MAAAA,MAAM,EAAE2C,GADC;AAET1C,MAAAA,OAAO,EAAEwC,IAFA;AAGTvC,MAAAA,UAAU,EAAE4C,OAHH;AAITE,MAAAA,KAAK,EAAED;AAJE,KAAD,CAAV;AAOAzC,IAAAA,SAAS,CAAE2C,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnB1C,MAAAA,GAAG,EAAE;AAFc,KAAX,CAAD,CAAT;AAKAwB,IAAAA,SAAS,CAAEkB,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBjB,MAAAA,WAAW,EAAE,IAFM;AAGnBC,MAAAA,YAAY,EAAE,KAHK;AAInBC,MAAAA,eAAe,EAAE,KAJE;AAKnBC,MAAAA,WAAW,EAAE;AALM,KAAX,CAAD,CAAT;AAQA,QAAIe,GAAG,GAAG,IAAIC,IAAJ,CAAS,YAAT,CAAV;AACAC,IAAAA,YAAY,CAACC,OAAb,CAAqB,gBAArB,EAAuCH,GAAG,CAAC1E,QAAJ,EAAvC;AACA4E,IAAAA,YAAY,CAACC,OAAb,CAAqB,KAArB,EAA4B,KAA5B;AACAD,IAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6B,IAA7B;AACD;AAED;;AAEA;AAEA;AACA;AACA;;;AAEA,WAASC,WAAT,GAAsB;AACpBlB,IAAAA,OAAO,CAACC,GAAR,CAAY,gCAAZ;AACA/B,IAAAA,SAAS,CAAE2C,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBzC,MAAAA,oBAAoB,EAAE;AAFH,KAAX,CAAD,CAAT;AAKAuB,IAAAA,SAAS,CAAEkB,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBjB,MAAAA,WAAW,EAAE,KAFM;AAGnBC,MAAAA,YAAY,EAAE,IAHK;AAInBC,MAAAA,eAAe,EAAE,KAJE;AAKnBC,MAAAA,WAAW,EAAE;AALM,KAAX,CAAD,CAAT;AAQAvE,IAAAA,MAAM,GAAGlB,IAAI,CAAC6G,OAAL,CAAa,gCAAb,EAA+C;AAACC,MAAAA,QAAQ,EAAE;AAAX,KAA/C,CAAT;AACA,QAAI/B,IAAI,GAAG;AACTxB,MAAAA,OAAO,EAAEH,OAAO,CAACG;AADR,KAAX;AAGA,QAAI/B,MAAM,GAAGT,KAAK,CAACM,OAAN,CAAcJ,eAAd,EAA+BQ,MAAM,CAACC,IAAP,CAAYC,IAAI,CAACC,SAAL,CAAemD,IAAf,CAAZ,CAA/B,CAAb;AACA,QAAIlD,UAAU,GAAGL,MAAM,CAACM,QAAP,CAAgB,KAAhB,CAAjB;AACAZ,IAAAA,MAAM,CAAC6F,OAAP,CAAe,eAAf,EAA+BlF,UAA/B;AACAX,IAAAA,MAAM,CAAC8F,EAAP,CAAU,SAAV,EAAqB,MAAM;AAEzB;AACA9F,MAAAA,MAAM,CAAC+F,SAAP,CAAiB7D,OAAO,CAACkD,KAAzB,EAAgC,UAAUY,GAAV,EAAe;AAC7C,YAAI,CAACA,GAAL,EAAU;AACRxB,UAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACA/B,UAAAA,SAAS,CAAE2C,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBxC,YAAAA,SAAS,EAAE;AAFQ,WAAX,CAAD,CAAT;AAID,SAND,MAOI;AACF2B,UAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ;AACD;AACF,OAXD;AAaA;;AACAzE,MAAAA,MAAM,CAAC8F,EAAP,CAAU,SAAV,EAAqB,CAACG,KAAD,EAAQnF,GAAR,KAAgB;AACjC,YAAGmF,KAAK,KAAK/D,OAAO,CAACkD,KAArB,EACE;AAEF,YAAIvB,IAAI,GAAGhD,OAAO,CAACC,GAAD,EAAMoB,OAAO,CAACI,UAAd,CAAlB;AACAkC,QAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2CZ,IAA3C,EALiC,CAMjC;;AAEA;;AACA,YAAGA,IAAI,CAACqC,MAAL,KAAgB,UAAnB,EACA;AACE,cAAGrC,IAAI,CAACpB,MAAR,EACA;AACE+B,YAAAA,OAAO,CAACC,GAAR,CAAY,2DAAZ;AACA/B,YAAAA,SAAS,CAAE2C,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBvC,cAAAA,UAAU,EAAE;AAFO,aAAX,CAAD,CAAT;AAIAG,YAAAA,MAAM,CAAEoC,IAAD,KAAW,EAChB,GAAGA,IADa;AAEhBhC,cAAAA,GAAG,EAAE;AAFW,aAAX,CAAD,CAAN;AAID,WAXD,MAaA;AACEmB,YAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ;AACD;AACF;AAED;AApBA,aAqBK,IAAGZ,IAAI,CAACqC,MAAL,KAAgB,OAAnB,EACL;AACE,gBAAG,CAACrC,IAAI,CAACpB,MAAT,EACA;AACE+B,cAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACA;AACD;;AACD,gBAAGZ,IAAI,CAACsC,OAAR,EACEX,YAAY,CAACC,OAAb,CAAqB,SAArB,EAAgC5B,IAAI,CAACsC,OAArC;AACF5C,YAAAA,OAAO,CAAE8B,IAAD,KAAW,EACjB,GAAGA,IADc;AAEjB1B,cAAAA,IAAI,EAAE7C,GAAG,CAACF,QAAJ,EAFW;AAGjBiD,cAAAA,IAAI,EAAEA;AAHW,aAAX,CAAD,CAAP,CARF,CAeE;AACA;AACA;AACA;AACA;;AACA,gBAAIuC,EAAE,GAAG,IAAIb,IAAJ,CAAS1B,IAAI,CAACwC,UAAd,CAAT;AACA,gBAAIC,EAAE,GAAG,IAAIf,IAAJ,CAASC,YAAY,CAACe,OAAb,CAAqB,gBAArB,CAAT,CAAT,CArBF,CAuBE;AAEA;AACA;;AACA,gBAAGH,EAAE,CAACI,OAAH,KAAeF,EAAE,CAACE,OAAH,EAAlB,EACA,CACE;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACC,aAnDD,MAqDE;AACEhC,cAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACAD,cAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCe,YAAY,CAACe,OAAb,CAAqB,gBAArB,CAAzC;AACA/B,cAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCZ,IAAI,CAACwC,UAA1C;AACA9C,cAAAA,OAAO,CAAE8B,IAAD,KAAW,EACjB,GAAGA,IADc;AAEjBoB,gBAAAA,KAAK,EAAE,IAFU;AAGjBC,gBAAAA,GAAG,EAAE;AAHY,eAAX,CAAD,CAAP,CAJF,CASE;;AACAlB,cAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6B,KAA7B;AACD;AAEJ;AAED;AAhGK,eAiGA,IAAG5B,IAAI,CAACqC,MAAL,KAAgB,MAAnB,EACL;AACE;AACA;AACA;AACA,kBAAIE,EAAE,GAAG,IAAIb,IAAJ,CAAS1B,IAAI,CAACwC,UAAd,CAAT;AACA,kBAAIC,EAAE,GAAG,IAAIf,IAAJ,CAAS9C,MAAM,CAACM,cAAhB,CAAT;;AACA,kBAAG,CAACN,MAAM,CAACM,cAAR,IAA0BqD,EAAE,CAACI,OAAH,KAAeF,EAAE,CAACE,OAAH,EAA5C,EACA;AACE,oBAAI1E,SAAS,GAAGhC,EAAE,CAACiC,aAAH,CAAiBhC,eAAjB,EAAiC,KAAjC,CAAhB;AACA,oBAAIwB,OAAO,GAAG3B,IAAI,CAAC4B,SAAL,CAAeqC,IAAI,CAACwC,UAApB,CAAd;AACA,oBAAIrE,WAAW,GAAGF,SAAS,CAACD,MAAV,CAAiBN,OAAjB,EAA0BsC,IAAI,CAACnC,IAA/B,CAAlB;;AACA,oBAAGM,WAAH,EAAe;AACbuB,kBAAAA,OAAO,CAAE8B,IAAD,KAAW,EACjB,GAAGA,IADc;AAEjBhC,oBAAAA,GAAG,EAACQ,IAAI,CAACpB;AAFQ,mBAAX,CAAD,CAAP;AAIA+B,kBAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCZ,IAAI,CAACpB,MAA3C;AACD,iBAND,MAQE+B,OAAO,CAACC,GAAR,CAAY,0CAAZ;AACH,eAdD,MAgBED,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACH,aAxBI,MAyBA,IAAGZ,IAAI,CAACqC,MAAL,KAAgB,SAAnB,EACL;AACE,kBAAIE,EAAE,GAAG,IAAIb,IAAJ,CAAS1B,IAAI,CAACwC,UAAd,CAAT;AACA,kBAAIC,EAAE,GAAG,IAAIf,IAAJ,CAAS9C,MAAM,CAACM,cAAhB,CAAT;AACAyB,cAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCZ,IAAI,CAAC1C,GAAzC;;AACA,kBAAGiF,EAAE,CAACI,OAAH,KAAeF,EAAE,CAACE,OAAH,EAAlB,EAA+B;AAC7B,oBAAIxE,WAAW,GAAGH,MAAM,CAACgC,IAAI,CAACnC,IAAN,EAAY3B,eAAZ,EAA6B8D,IAAI,CAACwC,UAAlC,CAAxB;;AAEA,oBAAGrE,WAAH,EAAe;AACbU,kBAAAA,SAAS,CAAE2C,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBtC,oBAAAA,cAAc,EAACc,IAAI,CAACwC;AAFD,mBAAX,CAAD,CAAT;AAIAtC,kBAAAA,OAAO,CAAEsB,IAAD,KAAW,EACjB,GAAGvB,UADc;AAEjBT,oBAAAA,GAAG,EAAEvC,GAAG,CAACF,QAAJ,EAFY;AAGjBiD,oBAAAA,IAAI,EAAEA,IAHW;AAIjB8C,oBAAAA,GAAG,EAAE9C,IAAI,CAAC1C,GAJO;AAKjBA,oBAAAA,GAAG,EAAEN,OAAO,CAACgD,IAAI,CAAC1C,GAAN,EAAWe,OAAO,CAACI,UAAnB;AALK,mBAAX,CAAD,CAAP;AAQD,iBAbD,MAcI;AACFkC,kBAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACD;AAEF,eArBD,MAsBI;AACFD,gBAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACD;AAEF;AACJ,OAxLD;AAyLD,KA1MD;AA2MD;AAGD;;;AACA,WAASmC,cAAT,GAA0B;AACxBpC,IAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ,EADwB,CAExB;;AACA,QAAIoC,CAAC,GAAG,IAAItB,IAAJ,EAAR;AACA,QAAIuB,KAAK,GAAGD,CAAC,CAACjG,QAAF,EAAZ;AACA,QAAIc,IAAI,GAAGR,OAAO,CAACgB,OAAO,CAACG,OAAT,EAAkByE,KAAlB,CAAlB;AACA,QAAIjD,IAAI,GAAG;AACTuB,MAAAA,KAAK,EAAElD,OAAO,CAACkD,KADN;AAEThD,MAAAA,MAAM,EAAEF,OAAO,CAACE,MAFP;AAGT2E,MAAAA,EAAE,EAAED,KAHK;AAITpF,MAAAA,IAAI,EAAEA;AAJG,KAAX;AAMA,QAAIpB,MAAM,GAAGT,KAAK,CAACM,OAAN,CAAcJ,eAAd,EAA+BQ,MAAM,CAACC,IAAP,CAAYC,IAAI,CAACC,SAAL,CAAemD,IAAf,CAAZ,CAA/B,CAAb;AACA,QAAIlD,UAAU,GAAGL,MAAM,CAACM,QAAP,CAAgB,KAAhB,CAAjB;AACAqC,IAAAA,MAAM,CAAEoC,IAAD,KAAW,EAChB,GAAGA,IADa;AAEhBnC,MAAAA,kBAAkB,EAAE,IAFJ;AAGhBC,MAAAA,GAAG,EAAEU,IAHW;AAIhBT,MAAAA,EAAE,EAAEzC;AAJY,KAAX,CAAD,CAAN;AAOAwD,IAAAA,SAAS,CAAEkB,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBjB,MAAAA,WAAW,EAAE,KAFM;AAGnBC,MAAAA,YAAY,EAAE,KAHK;AAInBC,MAAAA,eAAe,EAAE,IAJE;AAKnBC,MAAAA,WAAW,EAAE;AALM,KAAX,CAAD,CAAT;AAQAvE,IAAAA,MAAM,CAAC6F,OAAP,CAAe,mBAAf,EAAoClF,UAApC;AACD;AAGD;;;AACA,WAASqG,UAAT,GAAqB;AACnB;AACA;AACAxC,IAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ;AACAlB,IAAAA,OAAO,CAAE8B,IAAD,KAAW,EACjB,GAAGA,IADc;AAEjB7B,MAAAA,mBAAmB,EAAGM,UAAU,CAACG,KAAX,CAAiB3C,MAAjB,KAA4B;AAFjC,KAAX,CAAD,CAAP;AAIAyC,IAAAA,OAAO,CAAEsB,IAAD,KAAW,EACjB,GAAGA,IADc;AAEjBrB,MAAAA,mBAAmB,EAAGF,UAAU,CAACG,KAAX,CAAiB3C,MAAjB,KAA4B;AAFjC,KAAX,CAAD,CAAP;AAIA,QAAIuF,CAAC,GAAG,IAAItB,IAAJ,EAAR;AACA,QAAIuB,KAAK,GAAGD,CAAC,CAACjG,QAAF,EAAZ;AACA,QAAIiD,IAAI,GAAG;AACTuB,MAAAA,KAAK,EAAElD,OAAO,CAACkD,KADN;AAET2B,MAAAA,EAAE,EAAED,KAFK;AAGTG,MAAAA,MAAM,EAAGnD,UAAU,CAACG,KAAX,CAAiB3C,MAAjB,KAA4B,CAA7B,GAAkCwC,UAAU,CAACG,KAA7C,GAAoD;AAHnD,KAAX;AAKA,QAAI3D,MAAM,GAAGT,KAAK,CAACM,OAAN,CAAcJ,eAAd,EAA+BQ,MAAM,CAACC,IAAP,CAAYC,IAAI,CAACC,SAAL,CAAemD,IAAf,CAAZ,CAA/B,CAAb;AACA,QAAIlD,UAAU,GAAGL,MAAM,CAACM,QAAP,CAAgB,KAAhB,CAAjB;AAEA2C,IAAAA,OAAO,CAAE8B,IAAD,KAAW,EACjB,GAAGA,IADc;AAEjB5B,MAAAA,GAAG,EAAEqD,KAFY;AAGjBpD,MAAAA,GAAG,EAAC/C;AAHa,KAAX,CAAD,CAAP;AAMAwD,IAAAA,SAAS,CAAEkB,IAAD,KAAW,EACnB,GAAGA,IADgB;AAEnBjB,MAAAA,WAAW,EAAE,KAFM;AAGnBC,MAAAA,YAAY,EAAE,KAHK;AAInBC,MAAAA,eAAe,EAAE,KAJE;AAKnBC,MAAAA,WAAW,EAAE;AALM,KAAX,CAAD,CAAT;AASAvE,IAAAA,MAAM,CAAC6F,OAAP,CAAe,gBAAf,EAAiClF,UAAjC;AACD;;AAGD,WAASuG,OAAT,CAAiBC,CAAjB,EAAoB;AAClBpD,IAAAA,OAAO,CAAEsB,IAAD,KAAW,EACjB,GAAGA,IADc;AAEjBpB,MAAAA,KAAK,EAAEkD,CAAC,CAACC,MAAF,CAASC;AAFC,KAAX,CAAD,CAAP;AAID;;AAED,WAASC,KAAT,CAAeH,CAAf,EAAkB;AAChB;AACA3B,IAAAA,YAAY,CAACC,OAAb,CAAqB,KAArB,EAA4B0B,CAAC,CAACC,MAAF,CAASC,KAArC;AACD;AAGD;;;AACA,sBACE;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA,4BACE;AAAK,MAAA,KAAK,EAAG,aAAb;AAAA,8BACE;AAAK,QAAA,GAAG,EAAIE,OAAZ;AAAqB,QAAA,MAAM,EAAE,IAA7B;AAAkC,QAAA,KAAK,EAAC;AAAxC;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAKE;AAAK,MAAA,KAAK,EAAG;AAAb;AAAA;AAAA;AAAA;AAAA,YALF,eAME;AAAA;AAAA;AAAA;AAAA,YANF,eAOE;AAAK,MAAA,KAAK,EAAG,QAAb;AAAA,8BACE;AAAK,QAAA,KAAK,EAAG,SAAb;AAAA,gCACA,QAAC,MAAD;AAAQ,UAAA,SAAS,EAAG,QAApB;AAA6B,UAAA,EAAE,EAAG,SAAlC;AAA4C,UAAA,OAAO,EAAI7C,cAAvD;AAAA,uCAAwE;AAAM,YAAA,KAAK,EAAC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAxE;AAAA;AAAA;AAAA;AAAA;AAAA,gBADA,eAEA;AAAK,UAAA,KAAK,EAAG;AAAb;AAAA;AAAA;AAAA;AAAA,gBAFA,eAGA,QAAC,MAAD;AAAQ,UAAA,SAAS,EAAG,QAApB;AAA6B,UAAA,EAAE,EAAG,SAAlC;AAA6C,UAAA,OAAO,EAAEgB,WAAtD;AAAA,uCAAqE;AAAM,YAAA,KAAK,EAAC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAArE;AAAA;AAAA;AAAA;AAAA;AAAA,gBAHA,eAIA;AAAK,UAAA,KAAK,EAAG;AAAb;AAAA;AAAA;AAAA;AAAA,gBAJA,eAKA,QAAC,MAAD;AAAQ,UAAA,SAAS,EAAG,QAApB;AAA6B,UAAA,EAAE,EAAG,SAAlC;AAA4C,UAAA,OAAO,EAAEkB,cAArD;AAAA,uCAAuE;AAAM,YAAA,KAAK,EAAC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAvE;AAAA;AAAA;AAAA;AAAA;AAAA,gBALA,eAMA;AAAK,UAAA,KAAK,EAAG;AAAb;AAAA;AAAA;AAAA;AAAA,gBANA,eAOA,QAAC,MAAD;AAAQ,UAAA,SAAS,EAAG,QAApB;AAA6B,UAAA,EAAE,EAAG,SAAlC;AAA4C,UAAA,OAAO,EAAEI,UAArD;AAAiE,UAAA,QAAQ,EAAE,KAA3E;AAAA,iCAAkF;AAAM,YAAA,KAAK,EAAC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAlF;AAAA;AAAA;AAAA;AAAA,gBAPA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAYA;AAAK,QAAA,KAAK,EAAG,OAAb;AAAA,mBAEE,CAAC9C,YAAY,CAACE,WAAf,IAAgC,CAACF,YAAY,CAACG,YAA9C,IAAgE,CAACH,YAAY,CAACI,eAA9E,IAAmG,CAACJ,YAAY,CAACK,WAAjH,gBAEC;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,iCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAFD,gBAMD,qCARA,EAcEL,YAAY,CAACE,WAAd,IAA+BlC,OAAO,CAACG,OAAvC,gBAEC;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAGE;AAAA,sCAAeH,OAAO,CAACkD,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHF,eAIE;AAAA,uCAAgBlD,OAAO,CAACE,MAAxB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF,eAKE;AAAA,wCAAiBF,OAAO,CAACG,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFD,gBAUD,qCAxBA,EA8BG6B,YAAY,CAACG,YAAd,IAAgC5B,MAAM,CAACG,oBAAvC,gBACA;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,oBAEI,CAACH,MAAM,CAACI,SAAT,gBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,gBACqC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHxC;AAAA;AAAA;AAAA;AAAA,gBADA,GAQE,IAtCJ,EA0CGqB,YAAY,CAACI,eAAd,IAAmCtB,SAAS,CAACE,kBAA7C,gBACA;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,kCAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAGE;AAAK,YAAA,KAAK,EAAG,OAAb;AAAA,oCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAA,wCAAehB,OAAO,CAACkD,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE;AAAA,yCAAgBlD,OAAO,CAACE,MAAxB;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHF,EAKKY,SAAS,CAACG,GAAX,gBACA;AAAA,sCACE;AAAA,yDAA8BH,SAAS,CAACG,GAAV,CAAc4D,EAA5C;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA,sDAA2B/D,SAAS,CAACG,GAAV,CAAczB,IAAd,CAAmB8F,CAAnB,CAAqBC,SAArB,CAA+B,CAA/B,EAAiC,EAAjC,CAA3B,WAAsEzE,SAAS,CAACG,GAAV,CAAczB,IAAd,CAAmBgG,CAAnB,CAAqBD,SAArB,CAA+B,CAA/B,EAAiC,EAAjC,CAAtE;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBADA,gBAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAXJ,eAaE;AAAA,gDAAwBzE,SAAS,CAACI,EAAX,GAAiBJ,SAAS,CAACI,EAAV,CAAaqE,SAAb,CAAuB,CAAvB,EAAyB,EAAzB,IAA6B,KAA9C,GAAsD,IAA7E;AAAA;AAAA;AAAA;AAAA;AAAA,oBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHF,eAmBE;AAAK,YAAA,KAAK,EAAG,OAAb;AAAA,oCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,EAEIhF,MAAM,CAACK,UAAR,gBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAArB,gBAAuD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAF1D;AAAA;AAAA;AAAA;AAAA;AAAA,kBAnBF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADA,GA0BE,IApEJ,EAyEGoB,YAAY,CAACK,WAAd,IAA+BjB,UAAU,CAACE,mBAA1C,gBACA;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,kCAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI;AAAK,YAAA,KAAK,EAAG,OAAb;AAAA,oCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAA,wCAAetB,OAAO,CAACkD,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE;AAAA,uDAA+B9B,UAAU,CAACG,GAAZ,GAAmBH,UAAU,CAACG,GAA9B,GAAoC,IAAlE;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHF,eAIE;AAAA,0CAAkBH,UAAU,CAACI,GAAZ,GAAmBJ,UAAU,CAACI,GAAX,CAAe+D,SAAf,CAAyB,CAAzB,EAA2B,EAA3B,CAAnB,GAAoD,IAArE;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ,eAUI;AAAK,YAAA,KAAK,EAAG,OAAb;AAAA,oCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAGM;AAAA,sCACA;AAAA,qDAA2BnE,UAAU,CAACK,IAAZ,GAAoBL,UAAU,CAACK,IAAX,CAAgB8D,SAAhB,CAA0B,CAA1B,EAA4B,EAA5B,CAApB,gBAAsD;AAAA;AAAA,iCAAhF;AAAA;AAAA;AAAA;AAAA;AAAA,sBADA,eAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFA,EAIGnE,UAAU,CAACO,IAAZ,gBACA;AAAA,wCACE;AAAA,4DAA+BP,UAAU,CAACO,IAAX,CAAgBwC,UAA/C;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAA,wDAA2B/C,UAAU,CAACO,IAAX,CAAgBnC,IAAhB,CAAqB8F,CAArB,CAAuBC,SAAvB,CAAiC,CAAjC,EAAmC,EAAnC,CAA3B,WAAwEnE,UAAU,CAACO,IAAX,CAAgBnC,IAAhB,CAAqBgG,CAArB,CAAuBD,SAAvB,CAAiC,CAAjC,EAAmC,EAAnC,CAAxE;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBADA,gBAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAVF;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHN;AAAA;AAAA;AAAA;AAAA;AAAA,kBAVJ,eA4CE;AAAK,YAAA,KAAK,EAAG,OAAb;AAAA,sBACI,CAACnE,UAAU,CAACD,GAAb,gBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAnB,gBAA4D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAD/D;AAAA;AAAA;AAAA;AAAA,kBA5CF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADA,GAkDE,IA3HJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAZA,eA8IE;AAAK,QAAA,KAAK,EAAE;AAACsE,UAAAA,KAAK,EAAC;AAAP,SAAZ;AAAA,gCACE,QAAC,IAAD,CAAM,KAAN;AAAA,kCACE,QAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE,QAAC,GAAD;AAAA,mCACE,QAAC,IAAD,CAAM,OAAN;AAAc,cAAA,IAAI,EAAC,MAAnB;AAA0B,cAAA,WAAW,EAAC,UAAtC;AAAiD,cAAA,QAAQ,EAAET,OAA3D;AAAoE,cAAA,KAAK,EAAEpD,UAAU,CAACG,KAAtF;AAA6F,cAAA,KAAK,EAAE;AAAC0D,gBAAAA,KAAK,EAAC;AAAP;AAApG;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAOE;AAAA;AAAA;AAAA;AAAA,gBAPF,eAQE,QAAC,IAAD,CAAM,KAAN;AAAA,kCACE,QAAC,IAAD,CAAM,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE,QAAC,GAAD;AAAA,oCACE,QAAC,IAAD,CAAM,OAAN;AAAc,cAAA,IAAI,EAAC,MAAnB;AAA0B,cAAA,WAAW,EAAC,iBAAtC;AAAwD,cAAA,QAAQ,EAAEL,KAAlE;AAAyE,cAAA,KAAK,EAAE;AAACK,gBAAAA,KAAK,EAAC;AAAP;AAAhF;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,MAAD;AAAQ,cAAA,EAAE,EAAG,SAAb;AAAuB,cAAA,KAAK,EAAE;AAACA,gBAAAA,KAAK,EAAC;AAAP,eAA9B;AAA+C,cAAA,OAAO,EAAEX,UAAxD;AAAoE,cAAA,QAAQ,EAAE,KAA9E;AAAA,qCACA;AAAM,gBAAA,KAAK,EAAC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBARF;AAAA;AAAA;AAAA;AAAA;AAAA,cA9IF,EAuKGlD,UAAU,CAACE,mBAAZ,gBACA;AAAK,QAAA,KAAK,EAAG,OAAb;AAAA,gCAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,eAIE;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,sCAAe9B,OAAO,CAACkD,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAGE;AAAA,qDAA+B9B,UAAU,CAACG,GAAZ,GAAmBH,UAAU,CAACG,GAA9B,GAAoC,IAAlE;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHF,eAIE;AAAA,iDAA2BK,UAAU,CAACG,KAAZ,GAAqBH,UAAU,CAACG,KAAhC,GAAwC,IAAlE;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF,eAKE;AAAA,wCAAkBX,UAAU,CAACI,GAAZ,GAAmBJ,UAAU,CAACI,GAAX,CAAe+D,SAAf,CAAyB,CAAzB,EAA2B,EAA3B,CAAnB,GAAoD,IAArE;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAYE;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,iDAA2BnE,UAAU,CAACK,IAAZ,GAAoBL,UAAU,CAACK,IAAX,CAAgB8D,SAAhB,CAA0B,CAA1B,EAA4B,EAA5B,CAApB,gBAAsD;AAAA;AAAA,6BAAhF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHF,EAKKnE,UAAU,CAACO,IAAZ,gBACA;AAAA,oCACE;AAAA,wDAA+BP,UAAU,CAACO,IAAX,CAAgBwC,UAA/C;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAA,oDAA2B/C,UAAU,CAACO,IAAX,CAAgBnC,IAAhB,CAAqB8F,CAArB,CAAuBC,SAAvB,CAAiC,CAAjC,EAAmC,EAAnC,CAA3B,WAAwEnE,UAAU,CAACO,IAAX,CAAgBnC,IAAhB,CAAqBgG,CAArB,CAAuBD,SAAvB,CAAiC,CAAjC,EAAmC,EAAnC,CAAxE;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE;AAAA,6CAAoBnE,UAAU,CAACO,IAAX,CAAgB+D,KAApC;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHF,eAIE;AAAA,kDAAyBtE,UAAU,CAACO,IAAX,CAAgBsC,OAAzC;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADA,gBAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAZJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAZF,eA4BE;AAAK,UAAA,KAAK,EAAG,OAAb;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAA,sCAAejE,OAAO,CAACkD,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,EAIK9B,UAAU,CAACO,IAAX,IAAmBP,UAAU,CAACmD,KAA/B,gBACA;AAAA,oCACE;AAAA,iDAAwBnD,UAAU,CAACO,IAAX,CAAgB+D,KAAxC;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAA,mDAA0BtE,UAAU,CAACO,IAAX,CAAgBsC,OAA1C;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF,eAGE;AAAA,0DAAiC7C,UAAU,CAACmD,KAAX,CAAiBtF,GAAjB,CAAqBsG,SAArB,CAA+B,CAA/B,EAAiC,EAAjC,IAAqC,KAAtE;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHF,eAIE;AAAA,0DAAiCnE,UAAU,CAACmD,KAAX,CAAiB/E,IAAjB,CAAsB8F,CAAtB,CAAwBC,SAAxB,CAAkC,CAAlC,EAAoC,EAApC,CAAjC,WAA+EnE,UAAU,CAACmD,KAAX,CAAiB/E,IAAjB,CAAsBgG,CAAtB,CAAwBD,SAAxB,CAAkC,CAAlC,EAAoC,EAApC,CAA/E;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADA,gBAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAXJ,eAaE;AAAA,wCAAkBnE,UAAU,CAACoD,GAAZ,GAAmBpD,UAAU,CAACoD,GAAX,CAAee,SAAf,CAAyB,CAAzB,EAA2B,EAA3B,CAAnB,GAAoD,IAArE;AAAA;AAAA;AAAA;AAAA;AAAA,kBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,gBA5BF,eA4CE;AAAK,UAAA,KAAK,EAAE;AAACI,YAAAA,eAAe,EAAE;AAAlB,WAAZ;AAAA,oBACEvE,UAAU,CAACD,GAAZ,gBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAlB,gBAAyC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAD1C;AAAA;AAAA;AAAA;AAAA,gBA5CF;AAAA;AAAA;AAAA;AAAA;AAAA,cADA,GAmDE,IA1NJ,EA+NGS,UAAU,CAACE,mBAAZ,gBACF;AAAK,QAAA,KAAK,EAAG,OAAb;AAAA,gCAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFJ,eAGI;AAAA,kCACA;AAAA,iDAA2BF,UAAU,CAACT,GAAZ,GAAmBS,UAAU,CAACT,GAAX,CAAeoE,SAAf,CAAyB,CAAzB,EAA2B,EAA3B,CAAnB,gBAAoD;AAAA;AAAA,6BAA9E;AAAA;AAAA;AAAA;AAAA;AAAA,kBADA,eAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFA,EAII3D,UAAU,CAACD,IAAZ,gBACA;AAAA,oCACC;AAAA,wCAAeC,UAAU,CAACD,IAAX,CAAgBwC,UAA/B;AAAA;AAAA;AAAA;AAAA;AAAA,oBADD,eAEC;AAAA,oDAA2BvC,UAAU,CAACD,IAAX,CAAgBnC,IAAhB,CAAqB8F,CAArB,CAAuBC,SAAvB,CAAiC,CAAjC,EAAmC,EAAnC,CAA3B,WAAwE3D,UAAU,CAACD,IAAX,CAAgBnC,IAAhB,CAAqBgG,CAArB,CAAuBD,SAAvB,CAAiC,CAAjC,EAAmC,EAAnC,CAAxE;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFD,eAGC;AAAA,4CAAmB3D,UAAU,CAACD,IAAX,CAAgBrD,IAAnC;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHD,eAIC;AAAA,yDAAgCsD,UAAU,CAAC6C,GAA3C;AAAA;AAAA;AAAA;AAAA;AAAA,oBAJD,eAKC;AAAA,sCAAa7C,UAAU,CAAC3C,GAAxB;AAAA;AAAA;AAAA;AAAA;AAAA,oBALD;AAAA;AAAA;AAAA;AAAA;AAAA,kBADA,gBAQE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAZL;AAAA;AAAA;AAAA;AAAA;AAAA,gBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADE,GAqBA,IApPF,eAwPE,QAAC,MAAD;AAAQ,QAAA,EAAE,EAAG,SAAb;AAAuB,QAAA,OAAO,EAAE,MAAM;AACpCqD,UAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6Be,YAAY,CAACe,OAAb,CAAqB,KAArB,CAA7B;AACA/B,UAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BX,UAAU,CAACE,mBAAvC;AACD,SAHD;AAAA,+BAGG;AAAM,UAAA,KAAK,EAAC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHH;AAAA;AAAA;AAAA;AAAA,cAxPF;AAAA;AAAA;AAAA;AAAA;AAAA,YAPF,eAsQA;AAAK,MAAA,GAAG,EAAI8D,cAAZ;AAA4B,MAAA,EAAE,EAAC,QAA/B;AAAwC,MAAA,KAAK,EAAC,KAA9C;AAAoD,MAAA,MAAM,EAAC;AAA3D;AAAA;AAAA;AAAA;AAAA,YAtQA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA0QD;;GAhsBQ7F,G;;KAAAA,G;AAksBT,eAAeA,GAAf","sourcesContent":["import React, { Component}  from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport mqtt from 'mqtt';\nimport {useCallback, useEffect, useState} from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Button from 'react-bootstrap/Button';\nimport {Container, Row, Col, ListGroup, ListGroupItem, Form} from 'react-bootstrap';\nimport myBackground from './background.jpg'\nimport bgpLogo from './router.svg'\nimport desktopMonitor from './desktop-monitor.svg'\n\nconst elliptic = require('elliptic');\nconst sha3 = require('js-sha3');\nvar ecies = require(\"eciesjs\");\nconst ec = new elliptic.ec('secp256k1');\nvar gateway1_pubKey = '02d3846591c11ef39031b9dd7594de19d2d2f99dd512892e13840b855194432975';\nvar client; //Instance to coimport React, { Component }  from 'react';\nvar sendMsg = \"HELLO\";\nvar bogus_priv = \"e6e1031b9eff10cd5b97a2f6a5ffc1d1d42e2ebd3eef6b050b8400259aaf3de1\";\n\n/*******************UTILITY FUNCTIONS*****************/\n/*\n'Encrypt' function receives 2 parameters:\n1. snd - An object\n2. pubK - public key of the receiver\n\nReturns the cipher string\n*/\nfunction encrypt(snd, pubK){\n  //Uses receivers public key to encrypt.\n  let cipher = ecies.encrypt(pubK, Buffer.from(JSON.stringify(snd)));\n  let cipher_str = cipher.toString('hex');\n  return cipher_str;\n}\n\n/*\n'Decrypt' function receives two parameters:\n1. rcv - Cipher text in the form of buffer.\n2. prvK - Own private key\n\nReturns the decrypted object\n*/\nfunction decrypt(rcv, prvK){\n  //Uses own private key to decrypt.\n  let cipher_str = rcv.toString();\n  // console.log(\"Received - Encrypted message (String): \", cipher_str);\n  let cipher = Buffer.from(cipher_str,'hex');\n  // console.log(\"Received - Encrypted message (Buffer): \", cipher);\n  var rcv_data = ecies.decrypt(prvK, cipher).toString();\n  rcv_data = JSON.parse(rcv_data);\n  return rcv_data;\n}\n\n/*\n'sign_it' function\nParameters:\n1. prvK - Own private key\n2. Other parameters which are to be concatenated,\nhashed and then signed can be accessed through 'arguments'.\n\n\nReturns the signature object of the form:\n{\n  r:string,\n  s: string,\n  recover paramters: number\n}\n*/\n\nfunction sign_it(prvK){\n  let msg =  \"\";\n  for (let i=1;i<arguments.length;i++)\n    msg += arguments[i];\n  let msgHash = sha3.keccak256(msg);\n  let signature = ec.sign(msgHash, prvK, \"hex\", {canonical: true});\n\n  //The signature below consists of parameters 'r' and 's'.\n  let sign_str = JSON.parse(JSON.stringify(signature));\n  return sign_str;\n}\n\n/**\n'verify' function:\nParameters:\n1. signature - An object same as the type returned by 'sign_it'\n2. pubK - public key to be verified with.\n3. Other parameters which are to be concatenated and hashed can be accessed through 'arguments'.\n\nReturn: Boolean value indicating the authentcation status.\n*/\nfunction verify(signature, pubK){\n  let pubKeyObj = ec.keyFromPublic(pubK,\"hex\");\n\n  let msg =  \"\";\n  for (let i=2;i<arguments.length;i++)\n    msg += arguments[i];\n  let msgHash = sha3.keccak256(msg);\n\n  let auth_status = pubKeyObj.verify(msgHash, signature);\n\n  return auth_status;\n}\n/******************COMPONENT FUNCTION***********************/\nfunction App() {\n\n  /***************INITILIAZING STATES********************/\n  //Set of keys\n  const [keyPair, setKeyPair] = useState({\n    pubKey: null,\n    privKey: null,\n    privKey_0x: null\n  })\n\n  const [toggle, setToggle] = useState(false);\n\n  //This state stores the status of the device.\n  const [status, setStatus] = useState({\n    gen: false, //Whether the keys have been generated.\n    start_button_clicked: false,\n    connected: false,\n    registered: false,\n    cur_time_stamp: null\n  });\n\n  const [regStatus, setReg] = useState({\n    reg_button_clicked: false,\n    req: null,\n    ct: null,\n    res: null\n  })\n\n  const [authStatus, setAuth] = useState({\n    auth_button_clicked: false,\n    ts1:null, //Timestamp when the device is sending the authentication request\n    ct1:null, //Cipher text when sending the request\n    res1: null, //Nonce as cipher text sent by the gateway as response 1\n    res2:null, //Authentication status as a cipher text as response 2 but not yet used\n    data: null, //Nonce (and receivers public key) received from the gateway\n    //data2: null, //Data to be send after receiving the nonce (receiver's public key)\n    //ct2: null, // cipher text for data2\n    res:null //Authentication status as a boolean value\n  })\n\n\n  const [commStatus, setComm] = useState({\n    comm_button_clicked: false,\n    devID: \"\",\n    res: null, //Whole message sent by gateway as cipher text\n    data: null,  //Decrypted form of Whole message\n    msg: null\n  })\n\n\n  const [buttonStatus, setButton] = useState({\n    keysClicked: false,\n    startClicked: false,\n    registerClicked: false,\n    authClicked: false,\n    data: null\n  })\n\n  // const [msg_to_send, setMsg] = useState(\"\");\n\n  useEffect(() => {\n      console.log(\"Key pair changed: \", keyPair);\n  }, [keyPair])\n\n  useEffect(() => {\n    console.log(\"Registration status changed: \", status.registered);\n}, [status.registered])\n\n  // useEffect(() => {\n  //   console.log(\"Comm status has been changed: \", commStatus);\n  // }, [commStatus])\n\n  /***************GENERATE KEYS HANDLER********************/\n  function handleGenerate(){\n    console.log(\"Generating key pair...\");\n\n    //Creating public and private keys for the device.\n    var pair = ec.genKeyPair();\n    var priv = pair.getPrivate(\"hex\");\n    // var priv = \"6b5be97bc9065592a6eb9444f90991ca32659673fb7307a44f6948193e7b44bf\";\n    var pub = ec.keyFromPrivate(priv).getPublic(true,\"hex\");\n    // var pub = \"0206fe0109380bb9fb59cfaf24c7db9626a9bed8d1ae3c89e50d2f7671e81ee023\";\n\n    var priv_0x = \"0x\" + priv;\n    var Id = sha3.keccak256(pub+gateway1_pubKey);\n\n    setKeyPair({\n      pubKey: pub,\n      privKey: priv,\n      privKey_0x: priv_0x,\n      devId: Id\n    })\n\n    setStatus((prev) => ({\n      ...prev,\n      gen: true\n    }));\n\n    setButton((prev) => ({\n      ...prev,\n      keysClicked: true,\n      startClicked: false,\n      registerClicked: false,\n      authClicked: false\n    }));\n\n    let dat = new Date(\"2000-01-01\");\n    localStorage.setItem('cur_time_stamp', dat.toString());\n    localStorage.setItem('old', false);\n    localStorage.setItem('gate', true);\n  }\n\n  /***************CONNECTING AND SUBSCRIBING TO MQTT AND MAIN LOGIC FOR RECEIVING MESSAGES AND REPSONDING********************/\n\n  /***** This handler connects the device to the broker and subscribes to listen for responses *****/\n\n  // function respond_nonce(){\n  //   console.log(\"Wait...\");\n  // }\n\n  function handleStart(){\n    console.log(\"Device start button clicked...\");\n    setStatus((prev) => ({\n      ...prev,\n      start_button_clicked: true\n    }))\n\n    setButton((prev) => ({\n      ...prev,\n      keysClicked: false,\n      startClicked: true,\n      registerClicked: false,\n      authClicked: false\n    }));\n\n    client = mqtt.connect('mqtt://test.mosquitto.org:8081', {protocol: 'mqtts'});\n    let data = {\n      privKey: keyPair.privKey\n    }\n    let cipher = ecies.encrypt(gateway1_pubKey, Buffer.from(JSON.stringify(data)));\n    let cipher_str = cipher.toString('hex');\n    client.publish('gateway1/priv',cipher_str);\n    client.on('connect', () => {\n\n      /***************SUBSCRIBE TO DEVICE-ID********************/\n      client.subscribe(keyPair.devId, function (err) {\n        if (!err) {\n          console.log(\"Device started...\");\n          setStatus((prev) => ({\n            ...prev,\n            connected: true\n          }))\n        }\n        else{\n          console.log(\"Error starting the device...\");\n        }\n      });\n\n      /**********MESSAGE LISTENERS**************/\n      client.on('message', (topic, rcv) => {\n          if(topic !== keyPair.devId)\n            return;\n\n          var data = decrypt(rcv, keyPair.privKey_0x);\n          console.log(\"Gateway response received: \", data);\n          // console.log(\"Current time stamp: \", localStorage.getItem('cur_time_stamp'));\n\n          /***********REGISTRATION LISTENER***********/\n          if(data.remark === \"register\")\n          {\n            if(data.status)\n            {\n              console.log(\"Device has been registered...Proceed for authentication!!\");\n              setStatus((prev) => ({\n                ...prev,\n                registered: true\n              }))\n              setReg((prev) => ({\n                ...prev,\n                res: true\n              }))\n            }\n            else\n            {\n              console.log(\"Error registering the device...\");\n            }\n          }\n\n          /***********NONCE LISTENER***********/\n          else if(data.remark === \"nonce\")\n          {\n            if(!data.status)\n            {\n              console.log(\"Device not registered...\");\n              return;\n            }\n            if(data.recvKey)\n              localStorage.setItem('recvKey', data.recvKey);\n            setAuth((prev) => ({\n              ...prev,\n              res1: rcv.toString(),\n              data: data\n            }))\n\n\n            //We have received the nonce (and receivers public key)\n            //1. Check whether the timestamp is new.\n            //2. Check the gateway\n            //3. Hash the contents and sign it\n            //4. Encrypt with gateways public key and send.\n            let d1 = new Date(data.time_stamp);\n            let d2 = new Date(localStorage.getItem('cur_time_stamp'));\n\n            // console.log(\"d1: \", d1.toString(), \"\\nd2: \", d2.toString());\n\n            // 1.\n            // !status.cur_time_stamp\n            if(d1.getTime() > d2.getTime())\n            {\n              //2.\n              // let pubKeyObj = ec.keyFromPublic(gateway1_pubKey,\"hex\");\n              // let msgHash = sha3.keccak256(data.time_stamp);\n              // // console.log(\"Message hash: \", msgHash);\n              // let auth_status = pubKeyObj.verify(msgHash, data.sign);\n\n              // if(auth_status)\n              // {\n              //   //3.\n              //   // console.log(\"The text message and receiver public key just before sending: \", localStorage.getItem('msg'), \" \", localStorage.getItem('recvKey'));\n              //   //export NODE_OPTIONS=--openssl-legacy-provider\n              //   let recvKey = localStorage.getItem('recvKey');\n              //   let msg = (localStorage.getItem('msg').length === 0) ? \"\" : encrypt(localStorage.getItem('msg'), recvKey);\n              //   // bogus_priv\n              //   let sign = sign_it(keyPair.privKey, data.nonce);\n              //   let snd = {\n              //   devId: keyPair.devId,\n              //   sign: sign,\n              //   msg:  msg,\n              //   }\n              //   console.log(\"Sending the message: \", snd);\n              //   let enc_data = encrypt(snd, gateway1_pubKey);\n              //   client.publish('gateway1/auth', enc_data);\n\n              //   //Update the timestamp state.\n              //   // setStatus((prev) => ({\n              //   //   ...prev,\n              //   //   cur_time_stamp:data.time_stamp\n              //   // }))\n              //   setAuth((prev) => ({\n              //     ...prev,\n              //     data2: snd,\n              //     ct2: enc_data,\n              //   }))\n              //   // localStorage.setItem('old', false);\n              //   localStorage.setItem('gate', true);\n              //   localStorage.setItem('cur_time_stamp', data.time_stamp);\n              //   // console.log(\"Current time stamp now: \", localStorage.getItem('cur_time_stamp'));\n            // }\n            //   else\n            //   {\n            //     console.log(\"Gateway signature verification failed...\");\n            //     setAuth((prev) => ({\n            //       ...prev,\n            //       data2: null,\n            //       ct2: null\n            //     }))\n            //     localStorage.setItem('gate', false);\n            //   }\n            }\n            else\n              {\n                console.log(\"Timestamp is old: \");\n                console.log(\"Latest timestamp stored: \", localStorage.getItem('cur_time_stamp'));\n                console.log(\"Received time stamp: \", data.time_stamp);\n                setAuth((prev) => ({\n                  ...prev,\n                  data2: null,\n                  ct2: null\n                }))\n                // localStorage.setItem('old', true);\n                localStorage.setItem('gate', false);\n              }\n\n          }\n\n          /***********AUTH LISTENER***********/\n          else if(data.remark === \"auth\")\n          {\n            //This is the response from the gateway after processing the request.\n            //1. Check gateway.\n            //2. Check status.\n            let d1 = new Date(data.time_stamp);\n            let d2 = new Date(status.cur_time_stamp);\n            if(!status.cur_time_stamp || d1.getTime() > d2.getTime())\n            {\n              let pubKeyObj = ec.keyFromPublic(gateway1_pubKey,\"hex\");\n              let msgHash = sha3.keccak256(data.time_stamp);\n              let auth_status = pubKeyObj.verify(msgHash, data.sign);\n              if(auth_status){\n                setAuth((prev) => ({\n                  ...prev,\n                  res:data.status\n                }))\n                console.log(\"Auth status received: \", data.status);\n              }\n              else\n                console.log(\"Gateway signature verification failed...\");\n            }\n            else\n              console.log(\"Timestamp is old...\");\n          }\n          else if(data.remark === \"message\")\n          {\n            let d1 = new Date(data.time_stamp);\n            let d2 = new Date(status.cur_time_stamp);\n            console.log(\"Received a message: \", data.msg);\n            if(d1.getTime() > d2.getTime()){\n              let auth_status = verify(data.sign, gateway1_pubKey, data.time_stamp);\n\n              if(auth_status){\n                setStatus((prev) => ({\n                  ...prev,\n                  cur_time_stamp:data.time_stamp\n                }))\n                setComm((prev) => ({\n                  ...commStatus,\n                  res: rcv.toString(),\n                  data: data,\n                  enc: data.msg,\n                  msg: decrypt(data.msg, keyPair.privKey_0x)\n\n                }))\n              }\n              else{\n                console.log(\"Cannot verify gateway signature...\");\n              }\n\n            }\n            else{\n              console.log(\"Timestamp is old...\");\n            }\n\n          }\n      })\n    });\n  }\n\n\n  /***************DEVICE REGISTRATION HANDLER********************/\n  function handleRegister() {\n    console.log(\"Requesting registration...\");\n    //The devID, PubKey encrypted with gateway public key is sent to the gateway on the topic register1.\n    let d = new Date();\n    let d_str = d.toString();\n    let sign = sign_it(keyPair.privKey, d_str);\n    let data = {\n      devId: keyPair.devId,\n      pubKey: keyPair.pubKey,\n      TS: d_str,\n      sign: sign\n    }\n    let cipher = ecies.encrypt(gateway1_pubKey, Buffer.from(JSON.stringify(data)));\n    let cipher_str = cipher.toString('hex');\n    setReg((prev) => ({\n      ...prev,\n      reg_button_clicked: true,\n      req: data,\n      ct: cipher_str\n    }))\n\n    setButton((prev) => ({\n      ...prev,\n      keysClicked: false,\n      startClicked: false,\n      registerClicked: true,\n      authClicked: false\n    }));\n\n    client.publish('gateway1/register', cipher_str);\n  }\n\n\n  /***************DEVCE AUTHENTICATION HANDLER********************/\n  function handleAuth(){\n    //Here the device requests the gateway for authentication.\n    //The gateway responds by sending a nonce.\n    console.log(\"Requesting for authentication...\");\n    setAuth((prev) => ({\n      ...prev,\n      auth_button_clicked: (commStatus.devID.length === 0)\n    }))\n    setComm((prev) => ({\n      ...prev,\n      comm_button_clicked: (commStatus.devID.length !== 0)\n    }))\n    let d = new Date();\n    let d_str = d.toString();\n    let data = {\n      devId: keyPair.devId,\n      TS: d_str,\n      recvId: (commStatus.devID.length !== 0) ? commStatus.devID: null\n    }\n    let cipher = ecies.encrypt(gateway1_pubKey, Buffer.from(JSON.stringify(data)));\n    let cipher_str = cipher.toString('hex');\n\n    setAuth((prev) => ({\n      ...prev,\n      ts1: d_str,\n      ct1:cipher_str\n    }))\n\n    setButton((prev) => ({\n      ...prev,\n      keysClicked: false,\n      startClicked: false,\n      registerClicked: false,\n      authClicked: true\n    }));\n\n\n    client.publish('gateway1/nonce', cipher_str);\n  }\n\n\n  function onDevId(e) {\n    setComm((prev) => ({\n      ...prev,\n      devID: e.target.value\n    }))\n  }\n\n  function onMsg(e) {\n    // setMsg((prev) => (e.target.value));\n    localStorage.setItem('msg', e.target.value);\n  }\n\n\n  /************************COMPONENT TO BE RENDERED*****************************/\n  return (\n    <div className=\"App\">\n      <div class = \"page-header\">\n        <img src = {bgpLogo} height= \"45\" width=\"45\" />\n        <h1>  BGP Device </h1>\n      </div>\n      <div class = \"page-border\"></div>\n      <br></br>\n      <div class = \"parent\">\n        <div class = \"buttons\">\n        <Button className = \"button\" id = \"button1\" onClick = {handleGenerate}> <span class=\"front\"> Keys </span> </Button>\n        <div class = \"vertical\"></div>\n        <Button className = \"button\" id = \"button2\"  onClick={handleStart} > <span class=\"front\">Start the device </span></Button>\n        <div class = \"vertical\"></div>\n        <Button className = \"button\" id = \"button3\" onClick={handleRegister} > <span class=\"front\"> Register </span> </Button>\n        <div class = \"vertical\"></div>\n        <Button className = \"button\" id = \"button4\" onClick={handleAuth} disabled={false}><span class=\"front\">Authenticate </span></Button>\n        </div>\n\n\n      <div class = \"cards\">\n\n      {(!buttonStatus.keysClicked) && (!buttonStatus.startClicked) && (!buttonStatus.registerClicked) && (!buttonStatus.authClicked)?\n      (\n        <div class = \"card1\">\n          <h3> >> Hi, Welcome to BGP simulation </h3>\n        </div>\n      ) :\n      <>\n        {/* {console.log(\"Key pair not generated...\")} */}\n      </>\n      }\n\n\n      {(buttonStatus.keysClicked) && (keyPair.privKey) ?\n      (\n        <div class = \"card1\">\n          <h4> >> Keys </h4>\n\n          <p>Device Id: {keyPair.devId}</p>\n          <p>Public key: {keyPair.pubKey}</p>\n          <p>Private key: {keyPair.privKey}</p>\n        </div>\n      ) :\n      <>\n        {/* {console.log(\"Key pair not generated...\")} */}\n      </>\n      }\n\n\n      { (buttonStatus.startClicked) && (status.start_button_clicked) ?\n        <div class = \"card1\">\n\n          {(!status.connected) ?\n            (<h4> Connecting to broker</h4>) : (<p>Device Ready!</p>)\n          }\n\n        </div>\n        : null\n      }\n\n\n      { (buttonStatus.registerClicked) && (regStatus.reg_button_clicked) ?\n        <div class = \"card1\">\n\n          <h4>Requesting registration...</h4>\n          <div class = \"card2\">\n            <h5>Device to gateway</h5>\n            <p>Device ID: {keyPair.devId}</p>\n            <p>Public key: {keyPair.pubKey}</p>\n            {\n              (regStatus.req) ?\n              <div>\n                <p>Timestamp of the request: {regStatus.req.TS}</p>\n                <p>Signature (r, s): ( r: {regStatus.req.sign.r.substring(0,40)}, s: {regStatus.req.sign.s.substring(0,40)} )</p>\n              </div>\n              :\n              <p>Signing...</p>\n            }\n            <p>Encrypted request: {(regStatus.ct) ? regStatus.ct.substring(0,40)+\"...\" : null}</p>\n          </div>\n\n          <div class = \"card2\">\n            <h5>Gateway to device</h5>\n            {(status.registered)? <p>Registration status: TRUE</p> :<p>Registration status: FALSE</p> }\n          </div>\n\n        </div>\n        : null\n      }\n\n\n\n      { (buttonStatus.authClicked) && (authStatus.auth_button_clicked) ?\n        <div class = \"card1\">\n\n            <h4>Starting authentication process</h4>\n            <div class = \"card2\">\n              <h5>Request from device to gateway</h5>\n              <p>Device ID: {keyPair.devId}</p>\n              <p>Timestamp of the request: {(authStatus.ts1) ? authStatus.ts1 : null}</p>\n              <p>Cipher text: {(authStatus.ct1) ? authStatus.ct1.substring(0,40) : null}</p>\n            </div>\n\n            <div class = \"card2\">\n              <h5>lbr response</h5>\n              {\n                  <div>\n                  <p>Received cipher text: {(authStatus.res1) ? authStatus.res1.substring(0,40) : <>Waiting...</>}</p>\n                  <p>After decrypting: </p>\n                  {\n                    (authStatus.data) ?\n                    <div>\n                      <p>Timestamp of the response: {authStatus.data.time_stamp}</p>\n                      <p>Signature (r, s): ( r: {authStatus.data.sign.r.substring(0,40)}, s: {authStatus.data.sign.s.substring(0,40)} )</p>\n                      {/* <p>Nonce received: {authStatus.data.nonce}</p> */}\n                    </div>:\n                    <p>Waiting...</p>\n                  }\n                </div>\n              }\n\n            </div>\n\n          {/* <div class = \"card2\">\n            <h5>Device sending signed and encrypted nonce</h5>\n            <p>Device ID: {keyPair.devId}</p>\n            {\n              (authStatus.data2) ?\n              <div>\n                <p>Signing the nonce: {authStatus.data.nonce}</p>\n                <p>Device signature(r, s): ( r: {authStatus.data2.sign.r.substring(0,40)}, s: {authStatus.data2.sign.s.substring(0,40)} )</p>\n              </div>:\n              <p>Preparing response</p>\n            }\n            <p>Cipher text: {(authStatus.ct2) ? authStatus.ct2.substring(0,40) : null}</p>\n          </div> */}\n\n          <div class = \"card2\">\n            {(!authStatus.res)? <h5>Authentication successful!! :)</h5> :<h5>Authentication failed :(</h5> }\n          </div>\n\n        </div>\n        : null\n      }\n      </div>\n\n\n\n      {\n        <div style={{width:'50%'}}>\n          <Form.Group >\n            <Form.Label>Recipient deviceID: </Form.Label>\n            <Row>\n              <Form.Control type=\"text\" placeholder=\"deviceID\" onChange={onDevId} value={commStatus.devID} style={{width:'80%'}}/>\n            </Row>\n          </Form.Group>\n          <br></br>\n          <Form.Group>\n            <Form.Label>Message</Form.Label>\n            <Row>\n              <Form.Control type=\"text\" placeholder=\"Message to send\" onChange={onMsg} style={{width:'80%'}}/>\n              <Button id = \"button6\" style={{width:'100px'}} onClick={handleAuth} disabled={false}>\n              <span class=\"front\">\n                Send\n              </span>\n              </Button>\n        \n            </Row>\n          </Form.Group>\n        </div>\n\n      }\n\n\n      { (commStatus.comm_button_clicked) ?\n        <div class = \"card1\">\n\n          <p>Starting authenticated communication process</p>\n\n          <div class = \"card2\">\n            <h5>Request from device to gateway</h5>\n            <p>Device ID: {keyPair.devId}</p>\n            <p>Timestamp of the request: {(authStatus.ts1) ? authStatus.ts1 : null}</p>\n            <p>Receiver's device id: {(commStatus.devID) ? commStatus.devID : null}</p>\n            <p>Cipher text: {(authStatus.ct1) ? authStatus.ct1.substring(0,40) : null}</p>\n          </div>\n\n          <div class = \"card2\">\n            <h5>Gateway response</h5>\n            <p>Received cipher text: {(authStatus.res1) ? authStatus.res1.substring(0,40) : <>Waiting...</>}</p>\n            <p>After decrypting: </p>\n            {\n              (authStatus.data) ?\n              <div>\n                <p>Timestamp of the response: {authStatus.data.time_stamp}</p>\n                <p>Signature (r, s): ( r: {authStatus.data.sign.r.substring(0,40)}, s: {authStatus.data.sign.s.substring(0,40)} )</p>\n                <p>Nonce received: {authStatus.data.nonce}</p>\n                <p>Receiver public key: {authStatus.data.recvKey}</p>\n              </div>:\n              <p>Waiting...</p>\n            }\n          </div>\n\n          <div class = \"card2\">\n            <h5>Device sending encrypted message with signed nonce</h5>\n            <p>Device ID: {keyPair.devId}</p>\n            {\n              (authStatus.data && authStatus.data2) ?\n              <div>\n                <p>Nonce to be signed: {authStatus.data.nonce}</p>\n                <p>Recipient public key: {authStatus.data.recvKey}</p>\n                <p>Sending sample text message: {authStatus.data2.msg.substring(0,40)+\"...\"}</p>\n                <p>Device signature(r, s): ( r: {authStatus.data2.sign.r.substring(0,40)}, s: {authStatus.data2.sign.s.substring(0,40)} )</p>\n              </div>:\n              <p>Preparing response</p>\n            }\n            <p>Cipher text: {(authStatus.ct2) ? authStatus.ct2.substring(0,40) : null}</p>\n          </div>\n\n          <div style={{backgroundColor: '#d9f2de'}}>\n          {(authStatus.res)? <p>Message sent!!</p> :<p>Sending failed...</p> }\n          </div>\n\n\n        </div>\n        : null\n      }\n\n\n      {\n        (commStatus.comm_button_clicked) ?\n      <div class = \"card1\">\n      \n          <h5>Messages</h5>\n          <div >\n          <p>Received cipher text: {(commStatus.res) ? commStatus.res.substring(0,40) : <>...</>}</p>\n          <p>After decrypting:</p>\n           {\n             (commStatus.data) ?\n             <div>\n              <p>Timestamp: {commStatus.data.time_stamp}</p>\n              <p>Signature (r, s): ( r: {commStatus.data.sign.r.substring(0,40)}, s: {commStatus.data.sign.s.substring(0,40)} )</p>\n              <p>Received from: {commStatus.data.from}</p>\n              <p>Encrypted message received: {commStatus.enc}</p>\n              <p>Message: {commStatus.msg}</p>\n             </div>\n             : <p>...</p>\n           }\n          </div>\n      \n      </div>\n      : null\n    }\n\n    {\n        <Button id = \"button5\" onClick={() => {\n          console.log(\"Present msg: \", localStorage.getItem('msg'));\n          console.log(\"commStatus: \", commStatus.comm_button_clicked);\n        }}><span class=\"front\">Print</span></Button>\n    }\n\n    </div>\n    <img src = {desktopMonitor} id=\"img123\" width=\"800\" height=\"80\" />\n  </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}